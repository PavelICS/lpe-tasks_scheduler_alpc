# POC: ALPC TasksScheduler LPE for Windows 7 and other

Позволяет заменить содержимое любого файла, удовлетворяющих условиям:
  1) Администратор имеет права в него писать
  2) Файл не занят другими программами
    2.1) Если это exe, то процесс не запущен
    2.2) Если это dll, то она в данный момент никем не используется
 
# Применение

Загрузить на целевую машину екслойт ALPC-TaskSched-LPE.exe и нагрузку
Запуск:
  ALPC-TaskSched-LPE.exe target_file [payload_file]
payload_file по умолчанию payload.exe

# Примеры
Нас больше интересуют те файлы, которые находятся в автозапуске в планировщике задач, как сервисы, через реестр и прочие способы автозапуска.

Примерами целевых приложений могут быть
  - Задача "GoogleUpdateTaskMachine"
  - Задача "Системное обновление Браузера Яндекс"
  - Сервис "Microsoft .NET Framework NGEN"
  
  
Задача GoogleUpdate запускается от имени системы
  [!alt text](https://i.ibb.co/PrCH81v/Untitled.png)
  
Администратор имеет право писать в файл, отвечающий за обновления
  [!alt text](https://i.ibb.co/2dNsNBf/Untitled.png)
 
 Запуск експлойта для подмены файла обновления на произвольный другой
  [!alt text](https://i.ibb.co/g6T7Xhs/Untitled.png)
 
 При следующей попытке обновления отрабатывает подменённый файл от имени system, который запускает калькулятор
  [!alt text](https://i.ibb.co/8XzjscK/Untitled.png)
